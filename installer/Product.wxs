<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="*" 
             Name="Unity Cache Cleaner" 
             Language="1033" 
             Version="1.3.0" 
             Manufacturer="Serovectra" 
             UpgradeCode="4A02B604-D344-4C5B-8E37-C6D6F7C2C371">
        
        <Package InstallerVersion="200" 
                 Compressed="yes" 
                 InstallScope="perMachine"
                 Description="Unity Cache Cleaner - A tool for managing Unity project caches and credentials"
                 Comments="Beta Release 1.3.0" />

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
        <MediaTemplate EmbedCab="yes"/>

        <Feature Id="ProductFeature" Title="Unity Cache Cleaner" Level="1">
            <ComponentGroupRef Id="ProductComponents" />
            <ComponentRef Id="ApplicationShortcut" />
        </Feature>

        <!-- Start Menu Shortcut -->
        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="*">
                <Shortcut Id="ApplicationStartMenuShortcut" 
                         Name="Unity Cache Cleaner" 
                         Description="Clean Unity project caches and manage credentials"
                         Target="[#UnityCacheCleanerEXE]"
                         WorkingDirectory="INSTALLFOLDER"/>
                <RemoveFolder Id="CleanupShortcut" Directory="ApplicationProgramsFolder" On="uninstall"/>
                <RegistryValue Root="HKCU" Key="Software\Serovectra\UnityCacheCleaner" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
            </Component>
        </DirectoryRef>

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="INSTALLFOLDER" Name="Unity Cache Cleaner">
                    <!-- Application Files -->
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="Unity Cache Cleaner"/>
            </Directory>
        </Directory>

        <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
            <Component Id="ProductComponent" Guid="*">
                <File Id="UnityCacheCleanerEXE" Source="$(var.BinDir)\UnityCacheCleaner.exe" KeyPath="yes"/>
                <!-- Add other necessary files here -->
            </Component>
        </ComponentGroup>

        <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
        <UIRef Id="WixUI_InstallDir" />
    </Product>
</Wix>
